<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2014-03-06 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20140306" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Xored Integrity Maven Plugin - </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

    
                  </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Xored Integrity Maven Plugin</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2014-03-06
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 1.0.4-SNAPSHOT
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                              
      <li class="active">
  
            <a href="#"><i class="none"></i>Introduction</a>
          </li>
                
      <li>
  
                          <a href="plugin-info.html" title="Goals">
          <i class="none"></i>
        Goals</a>
            </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <h1>Xored Integrity Maven Plugin</h1>
<div class="section">
<h2>Overview<a name="Overview"></a></h2>
<p>This plugin helps you to ensure build integrity in case of a large multi-module project with branchy structure. For such a project, it is easy to forget to add a <tt>pom.xml</tt> file for a new module, or add a new module to the list of nested modules of the parent module. Especially, when you can run the project without Maven, e.g. when it&#x2019;s an Eclipse RCP application, which is built by Maven/Tycho on CI server, but developers run it from the workspace in Eclipse.</p>
<p>Things get worse, when many people with wide range of experience and responsibilities contribute to the project (some of them might not know about Maven at all), or when the fact, that a module is missing, is not so easy to notice (e.g. missing Eclipse plugin typically doesn&#x2019;t break a build).</p>
<p>This plugin scans project directory structure in attempt to find missed (not included to the build) modules. If it finds any missed modules, it marks the build failed.</p></div>
<div class="section">
<h2>Basic Setup<a name="Basic_Setup"></a></h2>
<p>Add this to the parent pom of your project:</p>

<div class="source">
<pre>&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;com.xored.maven&lt;/groupId&gt;
            &lt;artifactId&gt;integrity-maven-plugin&lt;/artifactId&gt;
            &lt;version&gt;LATEST_VERSION*&lt;/version&gt;
            &lt;executions&gt;
                &lt;execution&gt;
                    &lt;phase&gt;validate&lt;/phase&gt;
                    &lt;goals&gt;
                        &lt;goal&gt;verify-modules&lt;/goal&gt;
                    &lt;/goals&gt;
                &lt;/execution&gt;
            &lt;/executions&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;
</pre></div>
<p>(* When I was writing this doc, the latest version was 1.0.3.)</p>
<p>After that, you can continue to build you project as usual (e.g. <tt>mvn clean install</tt>).</p>
<p>The plugin gets a list of all module directories of your project (reactor project directories). Then, it determines the root of the entire project (the common root of all reactor project directories). When it&#x2019;s done, it scans the filesystem recursively starting from the root. For each directory, which looks like a module, it checks, if it exists in the list of reactor projects. If it doesn&#x2019;t, it is a missed module, and the plugin marks the build failed.</p></div>
<div class="section">
<h2>Configuration &amp; Example<a name="Configuration__Example"></a></h2>
<p>How does the plugin decide, if a directory looks like a module? When no configuration is given, each directory, which contains <tt>pom.xml</tt> file, is a module. You may redefine this behaviour by specifying includes/excludes configuration elements. They are <a class="externalLink" href="http://ant.apache.org/manual/dirtasks.html#patterns">Ant patterns</a>, which are applied to paths, relative to the project root. It is implied, that each pattern starts with <tt>**/</tt> and ends with <tt>/**</tt>. You <b>should not</b> specify this explicitly.</p>
<p>Suppose, you have the following config in your parent pom:</p>

<div class="source">
<pre>&lt;plugin&gt;
    &lt;groupId&gt;com.xored.maven&lt;/groupId&gt;
    &lt;artifactId&gt;integrity-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.0.3&lt;/version&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;id&gt;verify-modules&lt;/id&gt;
            &lt;phase&gt;validate&lt;/phase&gt;
            &lt;goals&gt;
                &lt;goal&gt;verify-modules&lt;/goal&gt;
            &lt;/goals&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
    &lt;configuration&gt;
        &lt;includes&gt;
            &lt;include&gt;pom.xml&lt;/include&gt;
            &lt;include&gt;feature.xml&lt;/include&gt;
            &lt;include&gt;META-INF/MANIFEST.MF&lt;/include&gt;
        &lt;/includes&gt;
        &lt;excludes&gt;
            &lt;exclude&gt;repository&lt;/exclude&gt;
            &lt;exclude&gt;product/**/bin&lt;/exclude&gt;
            &lt;exclude&gt;platform/**/META-INF/maven/**/pom.xml&lt;/exclude&gt;
            &lt;exclude&gt;*.updatesite/build&lt;/exclude&gt;
        &lt;/excludes&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;
</pre></div>
<p>This means, that</p>

<ul>
  
<li>Sub-directories, which match any of the patterns <tt>**/pom.xml/**</tt>, <tt>**/feature.xml/**</tt>,  <tt>**/META-INF/MANIFEST.MF/**</tt>, are modules. Note, that exact module directory is determined by the first path element,  which matches meaningful part of the pattern (not <tt>**/</tt>). So, if you have <tt>a/b/c/META-INF/MANIFEST.MF</tt>, <tt>a/b/c</tt> would  be a module, but not <tt>a/b/c/META-INF</tt>. If you want <tt>a/b/c/META-INF</tt> to be a module, you should specify  <tt>&lt;include&gt;MANIFEST.MF&lt;/include&gt;</tt> instead.</li>
  
<li>Sub-directories, which match any of the patterns <tt>**/repository/**</tt>, <tt>**/product/**/bin/**</tt>,  <tt>**/platform/**/META-INF/maven/**/pom.xml/**</tt>, <tt>**/*.updatesite/build/**</tt>, are <b>not</b> modules, even if they match  any of the <tt>includes</tt> patterns.</li>
</ul>
<p>Suppose, that this is your project structure:</p>

<div class="source">
<pre>.
&#x251c;&#x2500;&#x2500; platform
&#x2502;&#xa0;&#xa0; &#x251c;&#x2500;&#x2500; features
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x251c;&#x2500;&#x2500; feature-1
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x251c;&#x2500;&#x2500; feature.xml
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; pom.xml
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x251c;&#x2500;&#x2500; feature-1.updatesite
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; build
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0;     &#x2514;&#x2500;&#x2500; feature.xml
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; feature-2
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0;     &#x2514;&#x2500;&#x2500; feature.xml
&#x2502;&#xa0;&#xa0; &#x251c;&#x2500;&#x2500; plugins
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x251c;&#x2500;&#x2500; plugin-1
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x251c;&#x2500;&#x2500; META-INF
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; MANIFEST.MF
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; pom.xml
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x251c;&#x2500;&#x2500; plugin-2
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; META-INF
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0;     &#x251c;&#x2500;&#x2500; maven
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0;     &#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; a
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0;     &#x2502;&#xa0;&#xa0;     &#x2514;&#x2500;&#x2500; pom.xml
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0;     &#x2514;&#x2500;&#x2500; MANIFEST.MF
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; plugin-3
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0;     &#x2514;&#x2500;&#x2500; META-INF
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0;         &#x2514;&#x2500;&#x2500; this-is-not-a-module.txt
&#x2502;&#xa0;&#xa0; &#x251c;&#x2500;&#x2500; repository
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; q
&#x2502;&#xa0;&#xa0; &#x2502;&#xa0;&#xa0;     &#x2514;&#x2500;&#x2500; pom.xml
&#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; pom.xml
&#x251c;&#x2500;&#x2500; product
&#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; a
&#x2502;&#xa0;&#xa0;     &#x2514;&#x2500;&#x2500; b
&#x2502;&#xa0;&#xa0;         &#x2514;&#x2500;&#x2500; bin
&#x2502;&#xa0;&#xa0;             &#x2514;&#x2500;&#x2500; META-INF
&#x2502;&#xa0;&#xa0;                 &#x2514;&#x2500;&#x2500; MANIFEST.MF
&#x2514;&#x2500;&#x2500; releng
    &#x2514;&#x2500;&#x2500; parent
        &#x2514;&#x2500;&#x2500; pom.xml
</pre></div>
<p>As you can see, this resembles Eclipse RCP project, which is built by Maven/Tycho. Suppose also, that you run it like this:</p>

<div class="source">
<pre>$ cd releng/parent
$ mvn verify
</pre></div>
<p>In this case, modules are:</p>

<ul>
  
<li><tt>platform/features/feature-1</tt></li>
  
<li><tt>platform/features/feature-2</tt></li>
  
<li><tt>platform/plugins/plugin-1</tt></li>
  
<li><tt>platform/plugins/plugin-2</tt></li>
  
<li><tt>platform</tt></li>
  
<li><tt>releng/parent</tt></li>
</ul>
<p>Any other directory is not a module.</p>
<p>Modules <tt>platform/features/feature-2</tt> and <tt>platform/plugins/plugin-2</tt> are surely missed, since they lack <tt>pom.xml</tt>. So, the build will fail. The other modules may be missed as well, if they are not included to the parent poms, thus not included to the reactor build.</p></div>
<div class="section">
<h2>Notes<a name="Notes"></a></h2>
<p>The plugin automatically excludes build directories of reactor projects, so you <b>should not</b> explicitly specify anything like <tt>&lt;exclude&gt;path/to/my/module/target&lt;/exclude&gt;</tt>.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                   2014.
          All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        </body>
</html>
